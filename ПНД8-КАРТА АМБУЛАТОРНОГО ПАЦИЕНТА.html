<!-- изменил Пулин дата 18.08.2025 задача  -->
<!--Начальная дата разработки 20.06.2025 г.-->
<!--Разработка: Пулин -->
<!--Контекст печати: med_card_amb -->
<!--Задача: SUP-51938 Шаблоны приказа 274 -->

<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>МЕДИЦИНСКАЯ КАРТА</title>
<!-- @formatter:off -->
{: setPageSize('A4')}
{: setOrientation('P')}
{: setTopMargin(5)}
{: setBottomMargin(5)}
{: setRightMargin(17)}
{: setLeftMargin(17)}
{: from library.Utils import smartDict }

{: from library.Utils import forceString }
{: from library.Utils import forceInt }
{: from PyQt4 import QtGui }
{: db = QtGui.qApp.db }
{: from PyQt4.QtCore import QDate}

{: month = [u'a', u'января', u'февраля', u'марта', u'апрель', u'мая', u'июня', u'июля', u'августа', u'сентября', u'октября', u'ноября', u'декабря']}

{:
write('''
<style>
.h1 {
    text-align: center;
    margin-bottom: 20px;
    font-size: 12pt;
    font-weight: 900;
}
.main {
    font-family: 'Times New Roman';
    font-size: 8pt;
}
.xxl {
    font-size: 20pt;
}
.xl {
    font-size: 14pt;
}
.big {
    font-size: 12pt;
}
.small {
  font-size: 8pt;
}
.xs {
  font-size: 6pt;
}
.bold {
  font-weight: 900;
}
.red-line {
  text-indent: 10px;
}
.white-wrap {
  white-space: nowrap;
}
</style>
''')}




{:
def layoutSignRow(title='', person=''):
  return """
    <tr>
      <td colspan="2">
        <div>{title}</div>
      </td>
    </tr>
    <tr>
      <td>{person}</td>
      <td width="1%" class="white-wrap">подпись&nbsp;</td>
      <td width="1%" class="white-wrap">________&nbsp;</td>
    </tr>
  """.format(title=title, person=person)
}

{:
def render_line(str, base_length = 95):
  return u'_' * (base_length - len(str))
}

{:
address = client.regAddress

def formatAddress(obj):
  return forceString(obj).split(' ', -1)[0]

cladrCode = forceString(client.regAddress.KLADRCode)[8:11]
if cladrCode == '000':
  inCity = True
else:
  inCity = False
}

<!--  NOTE занятость если не будет исползоваться - удалить! -->
{:
workStatus = 'прочие'
workStatusCodeList = [u'1', u'2', u'с05', u'5', u'6', u'7']

workStatusDic = smartDict()
workStatusDic[u'1'] = u'прочие'
workStatusDic[u'6'] = u'пенсионер(ка)'
workStatusDic[u'5'] = u'не работает'
workStatusDic[u'2'] = u'студент(ка)'
workStatusDic[u'с05'] = u'работает'
workStatusDic[u'7'] = u'проходит военную службу или приравненную к ней службу'

for stat in client.socStatuses:
    if stat.code in workStatusCodeList:
      if stat.code == u'2':
        age = forceInt(forceString(client.age).split(' ', 1)[0])
        if age > 17:
          workStatus = workStatusDic[stat.code]
        else:
          workStatus = workStatusDic[u'1']
      else:
        workStatus = workStatusDic[stat.code]
}


{:
event_ref_list = db.getRecordList(stmt=u"""
  select e.id,
         DATE_FORMAT(e.setDate, '%d.%m.%Y') as event_set_date,
         et.name                            as event_type
    from Event e
             join EventType et on e.eventType_id = et.id and e.deleted = 0
    where e.client_id = {client_id}
    order by e.id desc ;
""".format(client_id=client.id))
}
{:
event_str_list = []
event_info_list = []
if event_ref_list:
    for ref in event_ref_list:
        event_set_date = forceString(ref.value(u'event_set_date'))
        event_type = forceString(ref.value(u'event_type'))
        id = forceInt(ref.value(u'id'))
        event_str_list.append(event_set_date + u' ' + event_type)
        event_info_list.append([id, event_set_date])
}

{:
event_id_dial = dialogs.dialList('выберите обращение', event_str_list, 0)
event_id, event_set_date = event_info_list[event_id_dial.getVar() if event_id_dial.getVar() else 0]
}

{:
eventInfoRef = db.getRecordEx(stmt=u"""
  select rbDR.name                                as event_result,
         DATE_FORMAT(e.setDate, '%d.%m.%Y')       as event_start_date,
         DATE_FORMAT(e.execDate, '%d.%m.%Y')      as event_exec_date,
         CONCAT_WS(' ', pExec.lastName, pExec.firstName, pExec.patrName) as person_exec,
         -- первичный, вторичный
         e.isPrimary,
         -- законченный случай лечения
         e.isClosed,
         ds.MKB,
         -- 1-по заболеванию, 2-с профилактической целью
         IF(ds.MKB between 'A00' and 'T98', 1, 2) as event_goal,
         IF(v.scene_id in (2, 3), 2, v.scene_id)  as visit_place,
         e.referral_id,
         e.goal_id,
         rbEG.code                                as visit_goal,
         IF(a.id is null, 0, 1)                   as is_hospital,
         e.`order`
  from Event e
           join Person pExec on e.execPerson_id = pExec.id and pExec.deleted = 0
           join Visit v on e.id = v.event_id
           join rbEventGoal rbEG on e.goal_id = rbEG.id
           left join Action a on e.id = a.event_id and a.actionType_id = 134
           join Diagnostic dc on e.id = dc.event_id and e.deleted = 0 and dc.deleted = 0 and e.id = {event_id}
           join rbDiagnosticResult rbDR on dc.result_id = rbDR.id
           join Diagnosis ds on dc.diagnosis_id = ds.id and ds.id = (select getEventDiagnosis({event_id}));
""".format(event_id=event_id))
}

{:
if eventInfoRef:
  event_result = forceString(eventInfoRef.value(u'event_result'))
  event_goal = forceString(eventInfoRef.value(u'event_goal'))
  visit_place = forceString(eventInfoRef.value(u'visit_place'))
  visit_goal = forceString(eventInfoRef.value(u'visit_goal'))
  is_hospital = forceString(eventInfoRef.value(u'is_hospital'))
  isClosed = forceString(eventInfoRef.value(u'isClosed'))
  isPrimary = forceString(eventInfoRef.value(u'isPrimary'))
  event_start_date = forceString(eventInfoRef.value(u'event_start_date'))
  event_exec_date = forceString(eventInfoRef.value(u'event_exec_date'))
  person_exec = forceString(eventInfoRef.value(u'person_exec'))
  if event_start_date != '':
    event_start_date = QDate.fromString(event_start_date, "dd.MM.yyyy")
  else:
    event_start_date = None
  if event_exec_date != '':
    event_exec_date = QDate.fromString(event_exec_date, "dd.MM.yyyy")
  else:
    event_exec_date = None

else:
  event_result = ''
  event_goal = ''
  visit_place = ''
  visit_goal = ''
  is_hospital = ''
  isClosed = ''
  isPrimary = ''
  person_exec = ''
  event_start_date = None
  event_exec_date = None
}

{:
financeRef = db.getRecordEx(stmt=u"""
  select rf.name
  from Event e
       join Visit v on e.id = v.event_id and v.deleted = 0
       join rbFinance rf on v.finance_id = rf.id
  where e.id = {event_id};
""".format(event_id=event_id))

if financeRef:
  finance = forceString(financeRef.value('name'))
else:
  finance = '-'
}



<!-- @formatter:-on -->
</head>
<body>




<div class="main">
  <header class="header">
    <table width="100%" cellpadding="0" cellspacing="0">
      <tr>
        <td width="1%" valign="top">
          <div class="white-wrap xs">
            <div>
              Санкт-Петербургское государственное 
            </div>
            <div>
              бюджетное учреждение здравоохранения 
            </div>
            <div>
              "Психоневрологический диспансер №8"
            </div>
            <div>
              Пр. Ю. Гагарина дом .18 кор.3, лит. А 
            </div>
            <div>
              Санкт-Петербург, 196211 
            </div>
            <div>
              Тел. (812) 241-3414 Факс: (812)241-3414 
            </div>
            <div>
              ИНН/КПП 7810208176/781001001
            </div>
          </div>
        </td>
        <td width="98%"></td>
        <td width="1%" valign="top" class="small white-wrap">
          <div class="white-wrap">Медицинская документация</div>
          <div class="white-wrap">Учетная форма № 025/у</div>
          <div class="white-wrap">
            Утверждена приказом Министерства здравоохранения от
          </div>
          <div class="white-wrap">13 мая 2025 г. № 274н</div>
          <div class="white-wrap">С дополнениями, утвержденными приказом главного врача СПб</div>
          <div class="white-wrap">ГБУЗ ПНД№8 от 59-од № 14.07.2025</div>
          <div class="xl">
            <div>
{:
attach_info_ref = db.getRecordEx(stmt=u"""
  select rbAT.name as attach_type,
         os.name   as orgstructure_name
  from ClientAttach ca
           join rbAttachType rbAT on ca.attachType_id = rbAT.id and ca.deleted = 0 and ca.client_id = {client_id}
           join OrgStructure os on ca.orgStructure_id = os.id and os.deleted = 0
  order by ca.id desc
  limit 1;
""".format(client_id=client.id))
if attach_info_ref:
  attach_type = forceString(attach_info_ref.value(u'attach_type'))
  orgstructure_name = forceString(attach_info_ref.value(u'orgstructure_name'))
else:
  attach_type = ''
  orgstructure_name = ''
}

              Тип прикрепления: <b>{attach_type}</b>
            </div>
            <div>
              Участок: <b>{orgstructure_name}</b>
            </div>
          </div>
        </td>
      </tr>
    </table>
  </header>

  <div align="center" class="h1">
    МЕДИЦИНСКАЯ КАРТА <br>
    ПАЦИЕНТА, ПОЛУЧАЮЩЕГО МЕДИЦИНСКУЮ ПОМОЩЬ <br>
    В АМБУЛАТОРНЫХ УСЛОВИЯХ № {event_id}
  </div>



<div class="big">
  <div>
    <!-- TODO event_start_date  -->
    Дата заполнения медицинской карты:
    {event_set_date}
  </div>

  <div>
    <div>Фамилия, имя, отчество (при наличии) пациента:</div>
    <div class="xxl"><b>{client.fullName}</b></div>
  </div>

  <div>
    Дата рождения: <b>{client.birthDate.toString(u'dd.MM.yyyy')}</b>
  </div>

  <div>
    Пол: <span class="xs">муж. – 1, жен. – 2</span>  <b>{1 if client.sex == u'М' else 2}</b>
    Гражданство: <b>{client.citizenship}</b>    
  </div>

  <div>
    Номер телефона: <b>{client.primaryPhones}</b>
    Адрес электронной почты: <b>{client.email if client.email != '' else '_' * 15}</b>
  </div>  
  
  <div>
    Документ, удостоверяющий личность: <b>{client.document.documentType}</b>
    серия <b>{client.document.serial}</b>
    № <b>{client.document.number}</b>
  </div>



  <div>
    <div>Регистрация по месту жительства:</div> 
    <div><b>{client.regAddress}</b></div>
  </div>

  <div>
    <div>Регистрация по месту пребывания: </div>
    <div><b>{client.locAddress}</b></div>
  </div>

  <div>
{:
represent_person_ref = db.getRecordEx(stmt=u"""
  select
      MAX(if(css.socStatusClass_id = 61, css.notes, '')) as fio,
      MAX(if(css.socStatusClass_id = 63, css.notes, '')) as phone
  from ClientSocStatus css
  where css.socStatusClass_id in (61, 63)
  and css.client_id = {client_id}
""".format(client_id=client.id))
if represent_person_ref:
    represent_fio = forceString(represent_person_ref.value('fio'))
    represent_phone = forceString(represent_person_ref.value('phone'))
else:
  represent_fio = ''
  represent_phone = ''
}

    <div>
      Сведения о лице, которому может быть передана информация о состоянии здоровья пациента:
      <b>{represent_fio}</b>{u', 'if represent_fio !='' and represent_phone !='' else ''}
      <b>{represent_phone}</b>
    </div>

  </div>
</div>

<div>
  Местность:
  {:incity = (str(client.regAddress.KLADRCode)[8:11] == '000')}
  {if: incity} <b>городская</b> {else:} <b>сельская</b> {end:}
</div>

<div>
  Полис обязательного медицинского страхования:
  серия <b>{client.policy.serial}</b>
  № <b>{client.policy.number}</b>
</div>

<div>
  дата выдачи полиса обязательного медицинского страхования:
  число
  {if: client.policy}
    <b>{client.policy.begDate.date.toString('dd')}</b>
  {end:}
  месяц
  {if: client.policy}
    <b>{forceString(month[client.policy.begDate.month])}</b>
  {end:}
  год
  {if: client.policy}
    <b>{forceString(client.policy.begDate.year)} г.</b>
  {end:}
</div>

<div align="justify">
  данные о страховой медицинской организации, выбранной застрахованным лицом или определенной застрахованному лицу:
  {client.compulsoryPolicy.insurer}
</div>

<div>
  Страховой номер индивидуального лицевого счёта: <b>{client.SNILS}</b>
</div>

<div>
  Код меры социальной поддержки
  {: soc_code = ''}
  <!-- проверяю наличие "льгота" в соц статусах -->
  {for: status in client.socStatuses}
    {if: status.classes == u"льгота"}
      {:soc_code = status.code}
    {end:}
  {end:}
  <!-- если есть "льгота", вывожу "код", если нет, вывожу нижнее подчеркивание -->
  {if: soc_code != ''}
    <b>{soc_code}</b>
  {else:}
    {: render_line(u'Код меры социальной поддержки')}
  {end:}
</div>



<div>
  Занятость: <span class="xs">работает – 1, проходит военную и приравненную к ней службу – 2; пенсионер – 3, обучающийся – 4, не работает – 5, прочее – 6</span>
  {: render_line(u'Занятость: работает – 1, проходит военную и приравненную к ней службу – 2; пенсионер – 3, обучающийся – 4, не работает – 5, прочее – 6')}
</div>

<div>
  Группа инвалидности:
  {if: client.disabilities}
    {if: client.disabilities[-1].recertificationDate}
      <b>{client.disabilities[-1].groupNumber}</b>
    {end:}
  {else:}
    {: render_line(u'Группа инвалидности:')}
  {end:}
</div>

<div>
  Место работы, место учебы:
  {if: client.work.shortName != ''}
    <b>{client.work.shortName} {client.work.post}</b>
  {else:}
    {: render_line(u'Место работы, место учебы:')}
  {end:}
</div>

<div>
  Признан нуждающимся в оказании паллиативной медицинской помощи: <span class="xs">не признан – 1; признан – 2</span>
  {:render_line(u'Признан нуждающимся в оказании паллиативной медицинской помощи: не признан – 1; признан – 2')}

</div>

<!--  note стр. 2 ф. № 025/у-->
<!--
note
  select * from Diagnosis where dispanser_id is not null ; записей нет
 -->
<div>
  <b>Хронические заболевания, функциональные расстройства, иные состояния, при наличии которых осуществляется диспансерное наблюдение:</b>
</div>

{:
dispanser_ref_list = db.getRecordList(stmt=u"""
  select mkb.DiagID                                                                   as diag_id,
         mkb.DiagName                                                                 as diag_name,
         ds.setDate,
         ds.endDate,
         CONCAT(p.lastName, ' ', LEFT(p.firstName, 1), '.', LEFT(p.patrName, 1), '.') as person_fio,
         rbS.name                                                                     as person_speciality,
         rbP.name                                                                     as person_post
  from Diagnosis ds
           join Diagnostic dc
                on ds.id = dc.diagnosis_id and ds.deleted = 0 and ds.dispanser_id is not null and dc.deleted = 0
           join MKB mkb on ds.MKB = mkb.DiagID
           join Event e on dc.event_id = e.id
           join Person p on e.execPerson_id = p.id
           join rbSpeciality rbS on p.speciality_id = rbS.id
           join rbPost rbP on p.post_id = rbP.id
  where e.client_id ={clientId};
""".format(clientId=client.id))
}



<table width="100%" cellpadding="3" cellspacing="0" border="1">
  <tr>
    <th valign="top">
      Дата начала <br> диспансерного <br> наблюдения
    </th>
    <th valign="top">
      Дата <br> прекращения <br> диспансерного <br> наблюдения
    </th>
    <th valign="top">
      Диагноз
    </th>
    <th>
      Код по <br> Международной <br> статистической <br> классификации <br> болезней и <br> проблем, <br> связанных со <br> здоровьем <br> (далее – МКБ)
    </th>
    <th valign="top">
      Фамилия, имя, <br>
      отчество (при наличии) <br> врача, наблюдающего <br> пациента, должность, <br> специальность
    </th>
  </tr>
  {if: dispanser_ref_list}
    {for: dispanser_ref in dispanser_ref_list}
      <tr>
        <td>{forceString(dispanser_ref.value(u'setDate'))}</td>
        <td>{forceString(dispanser_ref.value(u'endDate'))}</td>
        <td>{forceString(dispanser_ref.value(u'diag_name'))}</td>
        <td>{forceString(dispanser_ref.value(u'diag_id'))}</td>
        <td>
          <div>{forceString(dispanser_ref.value(u'person_fio'))}</div>
          <div>{forceString(dispanser_ref.value(u'person_speciality'))}</div>
          <div>{forceString(dispanser_ref.value(u'person_post'))}</div>
        </td>
      </tr>
    {end:}
  {else:}
    {for: _ in range(5)}
      <tr>
        <td>&nbsp;</td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
      </tr>
    {end:}
  {end:}

</table>

<div>
  <b>Лист записи заключительных (уточненных) диагнозов:</b>
</div>

{:
final_diag_ref_list = db.getRecordList(stmt=u"""
  select DATE_FORMAT(dc.setDate, '%d.%m.%Y')                                                          as diagSetDate,
         ds.MKB                                                                                       as mkb,
         mkb.DiagName                                                                                 as diag_name,
         CONCAT(p.lastName, ' ', CONCAT(LEFT(p.firstName, 1), '.'), CONCAT(LEFT(p.patrName, 1), '.')) as fio,
         rbS.name                                                                                     as speciality,
         rbP.name                                                                                     as post
  from Event e
           join Person p on e.execPerson_id = p.id and p.deleted = 0 and e.deleted = 0
           join rbSpeciality rbS on p.speciality_id = rbS.id
           join rbPost rbP on p.post_id = rbP.id
           join Diagnostic dc on e.id = dc.event_id and dc.deleted = 0
           join Diagnosis ds on dc.diagnosis_id = ds.id and ds.deleted = 0
           join MKB mkb on ds.MKB = mkb.DiagID
  where dc.diagnosisRationale_id = 3
    and dc.diagnosisNosologyType_id = 1
    and dc.diagnosisType_id in (1, 2)
    and e.client_id = {client_id}
  order by e.id desc;
""".format(client_id=client.id))
}

<table width="100%" cellpadding="3" cellspacing="0" border="1">
  <tr>
    <th width="1%" class="white-wrap">
      Дата&nbsp; <br>
      (число, месяц,&nbsp; <br>
      год)&nbsp;
    </th>
    <th valign="top" width="50%">Заключительные (уточненные) диагнозы</th>
    <th valign="top" width="1%" class="white-wrap">
      Код по <br> МКБ
    </th>
    <th valign="top" width="1%" class="white-wrap">
      Установленные&nbsp; <br> впервые – 1, <br> повторно – 2
    </th>
    <th valign="top" width="47%" class="white-wrap">
      Фамилия, имя, <br>
      отчество (при наличии) <br> врача, наблюдающего <br> пациента, должность, <br> специальность
    </th>
  </tr>
  {if: final_diag_ref_list}
    {for: final_diag_ref in final_diag_ref_list}
      <tr>
        <td>{forceString(final_diag_ref.value('diagSetDate'))}</td>
        <td>{forceString(final_diag_ref.value('diag_name'))}</td>
        <td>{forceString(final_diag_ref.value('mkb'))}</td>
        <td></td>
        <td>
          <div>{forceString(final_diag_ref.value('fio'))}</div>
          <div>{forceString(final_diag_ref.value('post'))}</div>
          <div>{forceString(final_diag_ref.value('speciality'))}</div>
        </td>
      </tr>
    {end:}
  {else:}
    {for: _ in range(5)}
      <tr>
        <td>&nbsp;</td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
      </tr>
    {end:}
  {end:}

</table>

  <!--  fix узнать источник информации-->
<div>
  Группа крови <b>{client.bloodTypeNumber}{client.bloodTypeName}</b>
  Резус-принадлежность {client.bloodTypeRhesus}
  антиген К1 системы Kell {'_' * 16}
  иные сведения групповой принадлежности крови (при наличии)
  {if: client.bloodNotes}
      <b>{client.bloodNotes}</b>
  {else:}
    {'_' * 16}
  {end:}
</div>

<div>Аллергические реакции на лекарственные препараты, пищевая аллергия или иные виды непереносимости в анамнезе, с указанием типа и вида аллергической реакции {'_' * 30}</div>

<!--  fix узнать источник информации-->
<div>
  Записи врачей-специалистов:
</div>
<section>
  <div>
    Дата осмотра {'_' * 16}
    на приеме, на дому, в фельдшерско-акушерском пункте, прочее. Врач (должность,
    специальность) {'_' * 16}
  </div>

  <div>
    Жалобы:
  </div>
  <div>
    Анамнез заболевания, жизни:
  </div>
  <div>
    Объективные данные
  </div>

  <!-- note таблица диагнозов -->
  <table width="100%" cellpadding="0" cellspacing="0">
    <tr>
      <td colspan="3">
         Диагноз основного заболевания: {'_' * 16}
      </td>
    </tr>
    <tr>
      <td>{'_' * 16}</td>
      <td width="1%" class="white-wrap">код по МКБ&nbsp;</td>
      <td width="1%" class="white-wrap">{'_' * 16}&nbsp;</td>
    </tr>
    <tr>
      <td>{'_' * 16}</td>
      <td width="1%" class="white-wrap">код по МКБ&nbsp;</td>
      <td width="1%" class="white-wrap">{'_' * 16}&nbsp;</td>
    </tr>

    <tr>
      <td>
        Осложнения: {'_' * 16}
      </td>
      <td width="1%" class="white-wrap">код по МКБ&nbsp;</td>
      <td width="1%" class="white-wrap">{'_' * 16}</td>
    </tr>
    <tr>
      <td>{'_' * 16}</td>
      <td width="1%" class="white-wrap">код по МКБ&nbsp;</td>
      <td width="1%" class="white-wrap">{'_' * 16}</td>
    </tr>

    <tr>
      <td>
        Сопутствующие заболевания: {'_' * 16}
      </td>
      <td width="1%" class="white-wrap">код по МКБ&nbsp;</td>
      <td width="1%" class="white-wrap">{'_' * 16}&nbsp;</td>
    </tr>
    <tr>
      <td>{'_' * 16}</td>
      <td width="1%" class="white-wrap">код по МКБ&nbsp;</td>
      <td width="1%" class="white-wrap">{'_' * 16}&nbsp;</td>
    </tr>

    <tr>
      <td colspan="3">
        Внешняя причина при травмах (отравлениях): {'_' * 16}
      </td>
    </tr>
    <tr>
      <td>{'_' * 16}</td>
      <td width="1%" class="white-wrap">код по МКБ&nbsp;</td>
      <td width="1%" class="white-wrap">{'_' * 16}&nbsp;</td>
    </tr>
  </table>

</section>
<!-- END Записи врачей-специалистов:-->

<!--  fix узнать источник информации-->
<div>
  Группа здоровья {'_' * 16}
  Диспансерное наблюдение {'_' * 16}
</div>

<table width="100%" cellpadding="3" cellspacing="0" border="1">
  <tr>
    <th width="50%">
      Назначения (исследования, консультации)
    </th>
    <th>
      Лекарственные препараты, физиотерапия
    </th>
  </tr>
  {for: _ in range(3)}
    <tr>
      <td>&nbsp;</td>
      <td></td>
    </tr>
  {end:}

  <tr>
    <th>
      Листок нетрудоспособности, справка
    </th>
    <th>
      Льготные рецепты
    </th>
  </tr>
  <tr>
    <td>&nbsp;</td>
    <td></td>
  </tr>
</table>

<table width="100%" cellpadding="3" cellspacing="0" border="1">
  <tr>
    <td>
      <div align="justify">Информированное добровольное согласие на медицинское вмешательство, отказ от медицинского вмешательства {'_' * 30}</div>
    </td>
  </tr>
  <tr>
    <td>
      <table width="100%" cellpadding="0" cellspacing="0">
        {write(layoutSignRow(u'Фамилия, имя, отчество (при наличии), должность, специальность лечащего врача', person_exec))}
      </table>
    </td>
  </tr>
</table>

  <!-- note стр. 3 ф. № 025/у-->
  <!--  fix узнать источник информации-->
<div>
  Медицинское наблюдение в динамике:
</div>

<table width="100%" cellpadding="3" cellspacing="0" border="1">
  <tr>
    <td colspan="2">
      Дата
    </td>
  </tr>
  <tr>
    <td colspan="2">
      Жалобы
    </td>
  </tr>
  <tr>
    <td>
      Данные наблюдения в динамике
    </td>
  </tr>
  <tr>
    <th>Назначения (исследования, консультации)</th>
    <th>Лекарственные препараты, физиотерапия</th>
  </tr>
  {for: _ in range(3)}
    <tr>
      <td>&nbsp;</td>
      <td></td>
    </tr>
  {end:}

  <tr>
    <th>Листок нетрудоспособности, справка</th>
    <th>Льготные рецепты</th>
  </tr>
  <tr>
    <td>&nbsp;</td>
    <td></td>
  </tr>

  <tr>
    <td></td>
    <td>
      Врач
    </td>
  </tr>
</table>

<!-- note  стр. 4 ф. № 025/у -->
<!--
note
  # Этапный эпикриз
  select * from ActionType where id = 14030;
  select * from ActionPropertyType where actionType_id = 14030 and !deleted;
-->
<section>
  <div>
    Этапный эпикриз
  </div>

  <div>
    Проведенное обследование, лечение и медицинская реабилитация
  </div>

  <!-- note вставить таблицу диагнозов -->

  <div>
    Рекомендации
  </div>

  <div>
    Листок нетрудоспособности (при наличии)
  </div>

  <table width="100%" cellpadding="0" cellspacing="0">
    {write(layoutSignRow(u'Фамилия, имя, отчество (при наличии), должность, специальность лечащего врача', person_exec))}
  </table>
</section>

  <!--  fix узнать источник информации-->
<section>
  <div>Консультация заведующего отделением</div>
  <div>Дата</div>
  <div>
    Жалобы и динамика состояния
  </div>
  <div>
    Проведенное обследование, лечение и медицинская реабилитация
  </div>


  <!-- note вставить таблицу диагнозов -->

  <div>
    Рекомендации по дальнейшему наблюдению, дообследованию, лечению и медицинской реабилитации
  </div>

  <div>
    Листок нетрудоспособности (при наличии)
  </div>

  <table width="100%" cellpadding="0" cellspacing="0">
    {write(layoutSignRow(u'Фамилия, имя, отчество (при наличии) заведующего отделением'))}
    {write(layoutSignRow(u'Фамилия, имя, отчество (при наличии), должность, специальность лечащего врача', person_exec))}
  </table>
</section>

<!--  note стр. 5 ф. № 025/у-->
<section>
  <div>Врачебная комиссия</div>
  <div>Дата</div>
  <div>
    Жалобы и динамика состояния
  </div>
  <div>
    Проведенное обследование, лечение и медицинская реабилитация
  </div>

  <!-- note вставить таблицу диагнозов -->

  <div>
    Решение врачебной комиссии:
  </div>
  <div>
    Рекомендации
  </div>

  <table width="100%" cellpadding="0" cellspacing="0">
    {:write(layoutSignRow(u'Фамилия, имя, отчество (при наличии), должность председателя'))}
    {:write(layoutSignRow(u'Фамилия, имя, отчество (при наличии), должность члена комиссии'))}

    {for: _ in range(3)}
      {:write(layoutSignRow(u'Фамилия, имя, отчество (при наличии), должность члена комиссии'))}
    {end:}
  </table>
</section>

<section>
  <div>Диспансерное наблюдение</div>
  <div>Дата</div>
  <div>
    Жалобы и динамика состояния
  </div>
  <div>
    Проведенное обследование, лечение и медицинская реабилитация
  </div>

  <!-- note вставить таблицу диагнозов -->

  <div>
    Рекомендации и дата следующего диспансерного осмотра, консультации
  </div>
  <table width="100%" cellpadding="0" cellspacing="0">
    {write(layoutSignRow(u'Фамилия, имя, отчество (при наличии), должность, специальность лечащего врача', person_exec))}
  </table>
</section>

<div align="justify">Сведения о периоде нахождения в медицинских организациях, оказывающих медицинскую помощь в стационарных условиях, в условиях дневного стационара </div>

<table width="100%" cellpadding="1" cellspacing="0" border="1">
  <tr>
    <th valign="top">
      Дата поступления <br>
      и выписки
    </th>
    <th valign="top">
      Наименование медицинской <br> организации, в которой была <br> оказана медицинская помощь <br>
      в стационарных условиях, <br>
      в условиях дневного стационара <br>
    </th>
    <th valign="top">
      Диагноз, установленный <br>
      в медицинской организации, <br>
      в которой была оказана <br> медицинская помощь  <br>
      в стационарных условиях, <br>
      в условиях дневного стационара<br>
    </th>
    <th valign="top">
      Код по МКБ
    </th>
  </tr>
  {for: _ in range(3)}
    <tr>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
  {end:}
</table>


<div>Сведения о проведенных оперативных вмешательствах в амбулаторных условиях</div>

<table width="100%" cellpadding="3" cellspacing="0" border="1">
  <tr>
    <th valign="top">Дата проведения</th>
    <th valign="top">Оперативное вмешательство</th>
    <th valign="top">
      Код <br>
      оперативного <br> вмешательства
    </th>
    <th valign="top">
      Фамилия, имя, отчество (при наличии), <br>
      должность, <br>
      специальность, подпись <br> лечащего врача
    </th>
  </tr>
  {for: _ in range(3)}
    <tr>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
  {end:}
</table>

<div>Лист учета доз облучения при рентгенологических исследованиях</div>

<table width="100%" cellpadding="3" cellspacing="0" border="1">
  <tr>
    <th>Дата проведения</th>
    <th>Название рентгенологического исследования</th>
    <th>Доза облучения</th>
  </tr>
  {for: _ in range(3)}
    <tr>
      <td></td>
      <td></td>
      <td></td>
    </tr>
  {end:}
</table>

<!-- note стр. 7 ф. № 025/у -->

<div>
  Результаты функциональных методов исследования:
</div>

<div>
  Результаты лабораторных методов исследования:
</div>

<!--  note стр. 8 ф. № 025/у -->
<div>
  Эпикриз
</div>

<table width="100%" cellpadding="0" cellspacing="0">
  {write(layoutSignRow(u'Фамилия, имя, отчество (при наличии), должность, специальность лечащего врача', person_exec))}
</table>

<div>
  Дата
</div>

</div>
</body>
</html>
