{: setPageSize('A4')}
{: setOrientation('P')}
{: setTopMargin(5)}
{: setBottomMargin(5)}
{: setRightMargin(17)}
{: setLeftMargin(17)}

{: from library.Utils import forceString }
{: from library.Utils import forceInt }
{: from PyQt4 import QtGui }
{: db = QtGui.qApp.db }

{:
write('''
<style>
.mL {
    margin-left: 10px;
}
</style>
''')}


{:
indexForRowspan2 = [2, 4, 6, 8, 10, 12, 14, 16, 24]
indexForRowspan3 = [18, 21]
def getRowspan(index):
  rowspan = 1
  if index in indexForRowspan2:
    rowspan = 2
  elif index in indexForRowspan3:
    rowspan = 3

  return rowspan
}

{:
def isNumberInRowspanList(index):
  return (index -1 in indexForRowspan2 or index - 2 in indexForRowspan3 or index - 1 in indexForRowspan3)

def conditionToRenderDiagCell(index):
  return not isNumberInRowspanList(index)

def conditionForMargin(index):
  return isNumberInRowspanList(index)
}

{:
def classMl(index):
  if conditionForMargin(index):
    return u'mL'
  else:
    return u''
}


  <table width="100%" cellpadding="3" cellspacing="0" border="1">
    <thead>
      <tr>
        <th width="95%">
          Наименование классов и отдельных заболеваний
        </th>
        <th class="white-wrap" width="1%">
          N&nbsp; <br>
          строки
        </th>
        <th class="white-wrap" width="1%">
          Код <br> МКБ-10
        </th>
        <th>
        Отметка о <br> наличии заболевания (+/-)
        </th>

        <th class="white-wrap" width="1%">
          Отметка об <br> установлении <br> диспансерного <br> наблюдения (+/-)
        </th>
        <th class="white-wrap" width="1%">
          Отметка о впервые <br> выявленном <br> заболевании (+/-)
        </th>
        <th class="white-wrap" width="1%">
          Отметка о впервые <br> установленном <br> диспансерном <br> наблюдении (+/-)
        </th>
      </tr>
      <tr>
        {for: index in range(1, 8)}
          <th>{index}</th>
        {end:}
      </tr>
    </thead>

    <tbody>
      {: cellDataList = [
        [u'Туберкулез органов дыхания', u'01', u'A15-A16'],
        [u'Злокачественные новообразования', u'02', u'C00-C97'],
        [u'Из них губы, полости рта и глотки', u'2.1', u'С00-С14'],
        [u'из них в 1-2 стадии', u'2.2', u'стадия 1-2'],
        [u'пищевода', u'2.3', u'С15'],
        [u'из них в 1-2 стадии', u'2.4', u'стадия 1-2'],
        [u'желудка', u'2.5', u'С16'],
        [u'из них в 1-2 стадии', u'2.6', u'стадия 1-2'],
        [u'тонкого кишечника', u'2.7', u'Cl7'],
        [u'из них в 1-2 стадии', u'2.8', u'стадия 1-2'],
        [u'ободочной кишки', u'2.9', u'С18'],
        [u'из них в 1-2 стадии', u'2.10', u'стадия 1-2'],
        [u'ректосигмоидного соединения, прямой кишки, заднего прохода (ануса) и анального канала', u'2.11', u'C19-C21'],
        [u'из них в 1-2 стадии', u'2.12', u'стадия 1-2'],
        [u'трахеи, бронхов, легкого', u'2.13', u'CЗЗ, C34'],
        [u'из них в 1-2 стадии', u'2.14', u'стадия 1-2'],
        [u'кожи', u'2.15', u'C43-C44'],
        [u'из них в 1-2 стадии', u'2.16', u'стадия 1-2'],
        [u'молочной железы', u'2.17', u'C50'],
        [u'из них в 0-1 стадии', u'2.18', u'стадия 0-1'],
        [u'2 стадии', u'2.19', u'стадия 2'],
        [u'шеики матки', u'2.20', u'C53'],
        [u'из них в 0-1 стадии', u'2.21', u'стадия 0-1'],
        [u'2 стадии', u'2.22', u'стадия 2'],
        [u'предстательной железы', u'2.23', u'C61'],
        [u'из них в 1-2 стадии', u'2.24', u'стадия 1-2'],
        [u'Сахарный диабет',  u'03', u'E10-E14'],
        [u'из него: инсулиннезависимый сахарный диабет', u'3.1', u'Е11'],
        [u'Преходящие церебральные ишемические приступы (атаки) и родственные синдромы', u'04', u'G45'],
        [u'Старческая катаракта и другие катаракты', u'05', u'H25, H26'],
        [u'Глаукома', u'06', u'H40'],
        [u'Слепота и пониженное зрение', u'07', u'Н54'],
        [u'Кондуктивная и нейросенсорная потеря слуха', u'08', u'Н90'],
        [u'Болезни системы кровообращения', u'09', u'I00-І99'],
        [u'из них: болезни, характеризующиеся повышенным кровяным давлением', u'9.1', u'I16—113'],
        [u'ишемические болезни сердца', u'9.2', u'I120-I125'],
        [u'цереброваскулярные болезни', u'9.3', u'I60-I69'],
        [u'из них: закупорка и стеноз прецеребральных и (или) церебральных артерий, не приводящие х инфаркту мозга', u'9.4', u'I65, I66'],
        [u'Болезни органов дыхания', u'10', u'J00-J99'],
        [u'Бронхит, не уточненный ках острый и хронический, простой и слизисто-гнойный хронический бронхит, хронический бронхит неуточненный, эмфизема', u'10.1', u'J40-J43'],
        [u'Другая хроническая обструктивная легочная болезнь, астма, астматический статус, бронхоэктатическая болезнь', u'10.2', u'J44-J47'],
        [u'Болезни органов пищеварения', u'11', u'K00-K93'],
        [u'язва желудка, язва двенадцатиперстной кишки', u'11.1', u'K25, K26'],
        [u'гастрит и дуоденит', u'12', u'K29'],
        [u'Прочие', u'13', u'']
      ]}

      {for: index, [cellName, cellNumber, diagCode] in enumerate(cellDataList)}
       <tr>
          <td>
            <div class="{classMl(index, cellName)}">{cellName}</div>
          </td>
          <td align="center">{cellNumber}</td>
          {if: conditionToRenderDiagCell(index)}
              <td align="center" rowspan="{getRowspan(index)}">3</td>
          {end:}
          <td>4</td>
          <td>5</td>
          <td>6</td>
          <td>7</td>
        </tr>
      {end:}
    </tbody>
  </table>